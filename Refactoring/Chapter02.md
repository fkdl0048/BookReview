## 2. 리팩터링 원칙

### 2.1 리팩터링 정의

수 많은 다른 소프트웨어 개발용어와 같이 리팩터링(Refactioring)이라는 단어도 다소 두루뭉실하게 사용된다.

*ex) 인터페이스, 도메인 등등*

저자는 이 용어을 더 구체적으로 사용해야 한다고 주장하며, 명사와 동사로도 사용 가능하다고 한다.

* 명사: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 기법
* 동사: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 여러 가지 리팩터링 기법을 적용해서 소프트웨어를 재구성하다.

지금껏 수많은 사람이 코드를 정리하는 작업을 모조리 `리팩터링`이라고 표현하고 있는데, 앞에서 제시한 정의에 따르면 **특정한 방식**에 따라 코드를 정리하는 것만이 리팩터링이다.

리팩터링은 결국 동작을 보존하는 작은 단계들을 거쳐 코드를 수정하고, 이러한 단계들을 순차적으로 연결하여 큰 변화를 만들어내는 일이다.

> 누군가 "리팩터링하다가 코드가 깨져서 며칠이나 고생했어"라고 한다면, 십중팔구 리팩터링한 것이 아니다.

코드베이스를 정리하거나 구조를 바꾸는 모든 작업을 재구성이라는 포괄적인 용어로 표현하고, 리팩터링은 재구성 중 한 형태이다.

한 번에 바꿀 수 있는 작업을 수 많은 단계로 잘게 나눠서 작업하는 모습을 처음 접하게 되면 리팩터링하는 것이 오히려 더 비효율적이라고 생각할 수 있는데, 잘게 나눌 수록 오히려 작업을 더 빨리 처리할 수 있다.

*작업은 사람이 하기에*

앞에서 리팩터링을 정의할 때 겉보기 동작이라는 표현을 사용했는데, 이는 리팩터링하기 전과 후의 코드가 똑같이 동작해야 한다는 뜻이다.

그렇다고 완전하게 똑같다는 말은 아니고 콜스택이나 동작 방식, 세부 사항이 변경되어도 목적하는 동작은 똑같이 수행되어야 한다는 뜻이다.

리팩터링은 성능 최적화와 비슷하게 둘 다 코드를 변경하지만 프로그램의 전반적인 기능은 그대로 유지한다.

단지 목적이 다를 뿐으로 리팩터링은 성능이 좋아질 수도 있고 나빠질 수도 있다.

### 2.2 두 개의 모자

소프트웨어 개발을 할 때 목적이 기능 추가냐 아니면 리팩터링이냐를 명확하게 구분해야 한다.

이를 `켄트 벡`은 **두 개의 모자**에 비유 했다.  

기능을 추가할 때는 기능 추가 모자를 쓴 다음 기존 코드는 건드리지 않고 새 기능을 추가하기만 한다.

반면, 리팩터링 모자를 쓴 다음 기능 추가는 절대 하지 않기로 다짐한 뒤 오로지 코드 재구성에만 전념한다.

*테스트도 새로 만들지 않는다.*

두 모자 모두 테스트는 필수적이다..!

소프트웨어개발을 하는동안 대부분의 프로그래머는 두 모자를 동시에 쓰고 있다.

두 모자는 한번에 존재할 수 없으니 잠깐 내려놓고 한 가지 모자만 선택해야 한다.

### 2.3 리팩터링하는 이유

리팩터링은 소프트웨어의 모든 문제점을 해결하는 만병통치약이 아니다.

